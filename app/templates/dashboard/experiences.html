{% extends "components/base.html" %}
{% block title %} Mindsight - Experiences{% endblock %}

{% block styles %}     
<link rel="stylesheet" href="/static/css/experiences.css"/>


{% endblock %}

{% block content %}

<div class="right">
    <div class="main">
        <div class="main-header">
            <span>
                <div>EXPERIENCES: </div>
                <div class="back-button">
                <a href="{{ url_for ('dashboard')}}">
                    <img src="/static/SVG/back_button.svg"/>
                </a>
                </div>
            </span>
        </div>
        <div class="content">
            <div class="box">
                <span>Junior High</span>
                <div id='jhs_container'></div>
            </div>
            <div class="box">
                <span>Senior High</span>
                <div id='shs_container'></div>
            </div>
            <div class="box">
                <span>College</span> 
                <div id='college_container'></div>
            </div>
            <div class="box">
                <span>Graduate</span> 
                <div id='grad_container'></div>
            </div>
            <div class="box">
                <span>Lifelong Learners</span>
                <div id='lll_container'></div>
            </div>
        </div>  
    </div>
</div>

<script>
    const jhs_data = {{ jhs_data | tojson | safe }};
    const shs_data = {{ shs_data | tojson | safe }};
    const college_data = {{ college_data | tojson | safe }};
    const grad_data = {{ grad_data | tojson | safe }};
    const lll_data = {{ lll_data | tojson | safe }};
     
    function renderChart(data, containerId) {
        const chartContainer = document.getElementById(containerId);
        chartContainer.innerHTML = '';
      
        const sortedData = Object.entries(data).sort((a, b) => b[1] - a[1]);
      
        sortedData.forEach(([label, count]) => {
          const progressBar = createProgressBar(label, count);
          chartContainer.appendChild(progressBar);
        });
      }
      

    function createProgressBar(label, count) {
  const container = document.createElement('div');
  container.classList.add('progress-bar-container');

  const labelElement = document.createElement('div');
  labelElement.classList.add('progress-bar-label');
  labelElement.textContent = label;
  container.appendChild(labelElement);

  const progressFlexContainer = document.createElement('div'); // Create progress flex container
  progressFlexContainer.classList.add('progress-flex-container'); // Add class to progress flex container

  const countElement = document.createElement('div');
  countElement.classList.add('progress-bar-count');
  countElement.textContent = count;
  progressFlexContainer.appendChild(countElement); // Append count element to progress flex container

  const barFlex = document.createElement('div'); // Create bar flex container
  barFlex.classList.add('bar-flex'); // Add class to bar flex container

  const maxProgressBarWidth = 100;

  const progressBarWidth = Math.min(count * 4, maxProgressBarWidth);
  const progressBar = document.createElement('div');
  progressBar.classList.add('progress-bar');
  progressBar.style.width = `${progressBarWidth}%`;
  barFlex.appendChild(progressBar); // Append progress bar to bar flex container

  const progressBarUnderlay = document.createElement('div');
  progressBarUnderlay.classList.add('progress-bar-underlay');
  barFlex.appendChild(progressBarUnderlay); // Append progress bar underlay to bar flex container

  progressFlexContainer.appendChild(barFlex); // Append bar flex container to progress flex container

  container.appendChild(progressFlexContainer); // Append progress flex container to main container

  // Return the created container
  return container;
}
    

    renderChart(jhs_data, 'jhs_container');
    renderChart(shs_data, 'shs_container');
    renderChart(college_data, 'college_container');
    renderChart(grad_data, 'grad_container');
    renderChart(lll_data, 'lll_container');
</script>

{% endblock %}