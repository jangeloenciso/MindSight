{% extends "components/base.html" %}
{% block title %} Mindsight - Experiences{% endblock %}

{% block styles %}     
<link rel="stylesheet" href="/static/css/experiences.css"/>
<style>
    .progress-bar-container {
      position: relative;
      margin-bottom: 10px;
    }
    
    .progress-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      background-color: #307fe2;
      color: white;
      padding: 5px;
    }
    
    .progress-bar-underlay {
      background-color: black;
      width: 100%;
      padding: 5px;
    }
  </style>

{% endblock %}

{% block content %}

<div class="right">
    <div class="main">
        <div class="main-header">
            <span>
                <div>EXPERIENCES: </div>
                <div class="back-button">
                <a href="{{ url_for ('dashboard')}}">
                    <img src="/static/SVG/back_button.svg"/>
                </a>
                </div>
            </span>
        </div>
        <div class="content">
            <div class="box">
                <span>Junior High</span>
                <div id='jhs_container'></div>
            </div>
            <div class="box">
                <span>Senior High</span>
                <div id='shs_container'></div>
            </div>
            <div class="box">
                <span>College</span> 
                <div id='college_container'></div>
            </div>
            <div class="box">
                <span>Graduate</span> 
                <div id='grad_container'></div>
            </div>
            <div class="box">
                <span>Lifelong Learners</span>
                <div id='lll_container'></div>
            </div>
        </div>  
    </div>
</div>

<script>
    const jhs_data = {{ jhs_data | tojson | safe }};
    const shs_data = {{ shs_data | tojson | safe }};
    const college_data = {{ college_data | tojson | safe }};
    const grad_data = {{ grad_data | tojson | safe }};
    const lll_data = {{ lll_data | tojson | safe }};
     
    function renderChart(data, containerId) {
        const chartContainer = document.getElementById(containerId);
        chartContainer.innerHTML = '';
      
        const sortedData = Object.entries(data).sort((a, b) => b[1] - a[1]);
      
        sortedData.forEach(([label, count]) => {
          const progressBar = createProgressBar(label, count);
          chartContainer.appendChild(progressBar);
        });
      }
      

    function createProgressBar(label, count) {
      const container = document.createElement('div');
      container.classList.add('progress-bar-container');
    
      const labelElement = document.createElement('div');
      labelElement.classList.add('progress-bar-label');
      labelElement.textContent = label;
      container.appendChild(labelElement);
    
      const countElement = document.createElement('div');
      countElement.classList.add('progress-bar-count');
      countElement.textContent = count;
      container.appendChild(countElement);
    
      const maxProgressBarWidth = 100;
    
      const progressBarWidth = Math.min(count * 4, maxProgressBarWidth);
      const progressBar = document.createElement('div');
      progressBar.classList.add('progress-bar');
      progressBar.style.width = `${progressBarWidth}%`;
      container.appendChild(progressBar);
    
      const progressBarUnderlay = document.createElement('div');
      progressBarUnderlay.classList.add('progress-bar-underlay');
      container.appendChild(progressBarUnderlay);
    
      return container;
    }
    

    renderChart(jhs_data, 'jhs_container');
    renderChart(shs_data, 'shs_container');
    renderChart(college_data, 'college_container');
    renderChart(grad_data, 'grad_container');
    renderChart(lll_data, 'lll_container');
</script>

{% endblock %}