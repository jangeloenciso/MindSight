<head>
  <style>
    table {
      font-family: arial, sans-serif;
      border-collapse: collapse;
      width: 100%;
    }

    td,
    th {
      border: 1px solid #dddddd;
      text-align: left;
      padding: 8px;
    }

    .flex {
      display: flex;
    }

    /* Apply page break only for letter size */
    @media print and (min-width: 7.7in) and (max-width: 7.8in) and (max-height: 11in) {
      .page-break {
        page-break-before: always;
      }
    }
  </style>
</head>

<body>
  <div class="flex" style="width: 100%; justify-content: center">
    <img
      src="/static/guidance_logo.png"
      alt="guidance logo"
      style="width: 40px; height: 40px"
    />
  </div>

  <!-- Displays the heading with the total number of clients for the specified year -->
  <h1 style="text-align: center">
    Total number of clients for the year {{ year }}
  </h1>
  <!-- Displays the overall total number of clients for the entire year -->
  <h2 style="text-align: center; margin-bottom: 40px">
    Overall yearly total: {{ overall_total.yearly }}
  </h2>

  <!-- Displays the heading for the overall monthly total -->
  <h3 style="line-height: 0.4">Overall Monthly Total:</h3>
  <!-- Creates a table to display the overall monthly total -->
  <table style="margin-bottom: 40px">
    <thead>
      <!-- Table header with columns for Month and Total -->
      <tr>
        <th>Month</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <!-- Iterates over each month and its total in the overall monthly total -->
      {% for month_num, month_total in overall_monthly_total.items() %}
      <!-- Sets the month name based on the month number -->
      {% set month_name = {1: 'January', 2: 'February', 3: 'March', 4: 'April',
      5: 'May', 6: 'June', 7: 'July', 8: 'August', 9: 'September', 10:
      'October', 11: 'November', 12: 'December'}[month_num] %}
      <!-- Creates a row with the month name and its total -->
      <tr>
        <td>{{ month_name }}</td>
        <td style="width: 50%">{{ month_total }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Displays the heading for the total number of clients per level -->
  <h3 style="line-height: 0.4">Total number of clients per level:</h3>
  <!-- Creates a table to display the total number of clients per level -->
  <table style="margin-bottom: 40px">
    <thead>
      <!-- Table header with columns for Colleges and each month -->
      <tr>
        <th>Colleges</th>
        <!-- Iterates over each month to display the month names as table headers -->
        {% for month_num in range(1, 13) %}
        <!-- Sets the month name based on the month number -->
        {% set month_name = {1: 'January', 2: 'February', 3: 'March', 4:
        'April', 5: 'May', 6: 'June', 7: 'July', 8: 'August', 9: 'September',
        10: 'October', 11: 'November', 12: 'December'}[month_num] %}
        <!-- Displays the month name as a table header -->
        <th>{{ month_name }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      <!-- Iterates over each college and its totals -->
      {% for college, totals in college_totals.items() %}
      <!-- Creates a row for each college -->
      <tr>
        <!-- Displays the college name in the first column -->
        <td>{{ college }}</td>
        <!-- Iterates over each month to display the total number of clients for each month -->
        {% for month_num in range(1, 13) %}
        <!-- Retrieves the total number of clients for the current month and college -->
        {% set month_total = totals['monthly'][month_num] if
        totals['monthly'].get(month_num) else 0 %}
        <!-- Displays the total number of clients for the current month and college -->
        <td>{{ month_total }}</td>
        {% endfor %}
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Apply the page break -->
  <div class="page-break"></div>

<!-- for cases -->
<!-- Displays the heading for the overall active, inactive, and terminated cases -->
<h3 style="line-height: 0.4">Overall Cases:</h3>
<!-- Creates a table to display the overall active, inactive, and terminated cases -->
<table style="margin-bottom: 40px">
  <thead>
    <!-- Table header with columns for Case Type and Total -->
    <tr>
      <th>Case Type</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <!-- Table rows for overall active, inactive, and terminated cases -->
    <tr>
      <td>Active</td>
      <td>{{ overall_active_total }}</td>
    </tr>
    <tr>
      <td>Inactive</td>
      <td>{{ overall_inactive_total }}</td>
    </tr>
    <tr>
      <td>Terminated</td>
      <td>{{ overall_terminated_total }}</td>
    </tr>
  </tbody>
</table>

<!-- Displays the heading for the monthly total for active cases -->
<h3 style="line-height: 0.4">Monthly Total for Active Cases:</h3>
<!-- Creates a table to display the monthly total for active cases -->
<table style="margin-bottom: 40px">
  <thead>
    <!-- Table header with columns for Month and Total -->
    <tr>
      <th>Month</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <!-- Iterates over each month and its total in the monthly total for active cases -->
    {% for month_num, month_total in overall_monthly_active_total.items() %}
    <!-- Sets the month name based on the month number -->
    {% set month_name = {1: 'January', 2: 'February', 3: 'March', 4: 'April',
    5: 'May', 6: 'June', 7: 'July', 8: 'August', 9: 'September', 10:
    'October', 11: 'November', 12: 'December'}[month_num] %}
    <!-- Creates a row with the month name and its total -->
    <tr>
      <td>{{ month_name }}</td>
      <td style="width: 50%">{{ month_total }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>


<!-- Displays the heading for the monthly total for inactive cases -->
<h3 style="line-height: 0.4">Monthly Total for Inactive Cases:</h3>
<!-- Creates a table to display the monthly total for inactive cases -->
<table style="margin-bottom: 40px">
  <thead>
    <!-- Table header with columns for Month and Total -->
    <tr>
      <th>Month</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <!-- Iterates over each month and its total in the monthly total for inactive cases -->
    {% for month_num, month_total in overall_monthly_inactive_total.items() %}
    <!-- Sets the month name based on the month number -->
    {% set month_name = {1: 'January', 2: 'February', 3: 'March', 4: 'April',
    5: 'May', 6: 'June', 7: 'July', 8: 'August', 9: 'September', 10:
    'October', 11: 'November', 12: 'December'}[month_num] %}
    <!-- Creates a row with the month name and its total -->
    <tr>
      <td>{{ month_name }}</td>
      <td style="width: 50%">{{ month_total }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Apply the page break -->
<div class="page-break"></div>

<!-- Displays the heading for the monthly total for terminated cases -->
<h3 style="line-height: 0.4">Monthly Total for Terminated Cases:</h3>
<!-- Creates a table to display the monthly total for terminated cases -->
<table style="margin-bottom: 40px">
  <thead>
    <!-- Table header with columns for Month and Total -->
    <tr>
      <th>Month</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <!-- Iterates over each month and its total in the monthly total for terminated cases -->
    {% for month_num, month_total in overall_monthly_terminated_total.items() %}
    <!-- Sets the month name based on the month number -->
    {% set month_name = {1: 'January', 2: 'February', 3: 'March', 4: 'April',
    5: 'May', 6: 'June', 7: 'July', 8: 'August', 9: 'September', 10:
    'October', 11: 'November', 12: 'December'}[month_num] %}
    <!-- Creates a row with the month name and its total -->
    <tr>
      <td>{{ month_name }}</td>
      <td style="width: 50%">{{ month_total }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>


  <script>
    // Trigger print window when the page loads
    window.onload = function () {
      window.print();
      // Handle window after print
      window.onafterprint = function () {
        // Redirect to the previous page
        window.history.back();
      };
    };
  </script>
</body>
